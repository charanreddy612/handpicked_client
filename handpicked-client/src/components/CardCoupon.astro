---
type Coupon = {
  id: string | number;
  title?: string | null;
  code?: string | null;
  ends_at?: string | null;
  merchant_name?: string | null;
};

const { coupon } = Astro.props as { coupon: Coupon };
---

<div
  class="bg-white border rounded-lg p-4 shadow-sm hover:shadow-md transition relative"
  x-data="{ revealed: false }"
>
  <!-- Merchant Name -->
  <h3 class="font-semibold text-gray-900 truncate">
    {coupon.merchant_name || "Store"}
  </h3>

  <!-- Coupon Title -->
  <p class="text-sm text-gray-700 mt-1">
    {coupon.title || "Special Offer"}
  </p>

  <!-- Ends At -->
  {
    coupon.ends_at && (
      <p class="text-xs text-gray-500 mt-1">
        Ends {new Date(coupon.ends_at).toLocaleDateString()}
      </p>
    )
  }

  <!-- Reveal Code Button -->
  <div class="mt-3">
    {
      coupon.code ? (
        <button
          class="w-full bg-green-600 text-white text-sm font-medium py-2 px-4 rounded hover:bg-green-700 transition"
          on-click="this.nextElementSibling.classList.remove('hidden'); this.classList.add('hidden');"
        >
          Reveal Code
        </button>
      ) : (
        <span class="inline-block bg-gray-200 text-gray-700 text-sm px-3 py-2 rounded">
          Activate Deal
        </span>
      )
    }

    {
      coupon.code && (
        <div class="hidden border border-dashed border-gray-400 text-center mt-2 py-2 rounded text-sm font-mono tracking-wide select-all">
          {coupon.code}
        </div>
      )
    }
  </div>
</div>
