---
import ChevronLeft from "./icons/ChevronLeft.astro";
import ChevronRight from "./icons/ChevronRight.astro";

const {
  prev = null,
  next = null,
  total_pages = undefined,
} = Astro.props as {
  prev?: string | null;
  next?: string | null;
  total_pages?: number;
};
---

<div class="flex items-center justify-between mt-6">
  <div class="text-sm text-gray-500">
    {
      typeof total_pages === "number" && total_pages > 0
        ? `Total pages: ${total_pages}`
        : ""
    }
  </div>
  <div class="flex items-center gap-2">
    {
      prev ? (
        <a
          href={prev}
          data-force-nav
          class="flex items-center gap-1 px-3 py-1.5 text-sm rounded border border-brand-primary text-brand-primary hover:bg-brand-primary hover:text-white transition"
        >
          <ChevronLeft size={18} /> Prev
        </a>
      ) : (
        <span class="flex items-center gap-1 px-3 py-1.5 text-sm rounded border border-gray-200 text-gray-400 bg-gray-50 cursor-not-allowed">
          <ChevronLeft size={18} /> Prev
        </span>
      )
    }
    {
      next ? (
        <a
          href={next}
          data-force-nav
          class="flex items-center gap-1 px-3 py-1.5 text-sm rounded border border-brand-primary text-brand-primary hover:bg-brand-primary hover:text-white transition"
        >
          Next <ChevronRight size={18} />
        </a>
      ) : (
        <span class="flex items-center gap-1 px-3 py-1.5 text-sm rounded border border-gray-200 text-gray-400 bg-gray-50 cursor-not-allowed">
          Next <ChevronRight size={18} />
        </span>
      )
    }
  </div>
</div>

<script is:inline>
  (function () {
    if (typeof window === "undefined") return;
    document.addEventListener(
      "click",
      function (e) {
        try {
          const a = e.target.closest && e.target.closest("a[data-force-nav]");
          if (!a) return;
          // If meta/ctrl/cmd/shift click â€” let browser handle (open in new tab/window)
          if (e.metaKey || e.ctrlKey || e.shiftKey || a.target === "_blank")
            return;
          e.preventDefault();
          // Use assign so history behaves like normal navigation
          window.location.assign(a.href);
        } catch (err) {
          // fallback: let default click happen
        }
      },
      { passive: false }
    );
  })();
</script>
